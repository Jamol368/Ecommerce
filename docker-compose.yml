version: "3.7"
services:
    nginx:
        image: nginx:latest
        container_name: nginx
        restart: unless-stopped
        ports:
            - 80:80
        volumes:
            - ./:/var/www/html
            - ./.docker/nginx/default.conf:/etc/nginx/conf.d/default.conf
        networks:
            - app
    php:
        container_name: php
        build:
            context: ./.docker/php
            dockerfile: Dockerfile
        ports:
            - 9000:9000
        volumes:
            -   ./:/var/www/html
        networks:
            - app
    mysql:
        image: mysql/mysql-server:8.0
        container_name: mysql
        ports:
            - 3306:3306
        environment:
            MYSQL_DATABASE: laravel
            MYSQL_ROOT_PASSWORD: password
            MYSQL_PASSWORD: password
            MYSQL_USER: sail
        volumes:
            - app-mysql:/var/lib/mysql
        networks:
            - app

networks:
    app:
        driver: bridge
volumes:
    app-mysql:
        driver: local


#version: '3'
#services:
#    laravel.test:
#        build:
#            context: ./vendor/laravel/sail/runtimes/8.2
#            dockerfile: Dockerfile
#            args:
#                WWWGROUP: '${WWWGROUP}'
#        image: sail-8.2/app
#        extra_hosts:
#            - 'host.docker.internal:host-gateway'
#        ports:
#            - '80:80'
#        environment:
#            WWWUSER: '${WWWUSER}'
#        volumes:
#            - '.:/var/www/html'
#        networks:
#            - sail
#        depends_on:
#            - mysql
#    mysql:
#        image: 'mysql/mysql-server:8.0'
#        ports:
#            - '3306:3306'
#        environment:
#            MYSQL_ROOT_PASSWORD: '${DB_PASSWORD}'
#            MYSQL_DATABASE: '${DB_DATABASE}'
#            MYSQL_USER: '${DB_USERNAME}'
#            MYSQL_PASSWORD: '${DB_PASSWORD}'
#        volumes:
#            - 'sail-mysql:/var/lib/mysql'
#        networks:
#            - sail
#networks:
#    sail:
#        driver: bridge
#volumes:
#    sail-mysql:
#        driver: local
